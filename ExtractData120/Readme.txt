ExtractData 1.20

制作者: 結羽
http://twin.tn.st/

開発環境:
Windows XP SP2, Core2Duo E6700, メモリ2GB
Visual C++ 2005 Express Edition SP1

動作環境:
Windows XP

XPでのみ動作確認を行っています。
2000やVistaでも動くかもしれません。

Windows 98/Meについてはサポート対象外とします。


■はじめに

主にえろげのアーカイブファイルを展開するツールです。
対応状況については「State.txt」を参照してください。

抽出したデータについては私的利用の範囲を超えないようにしてください。


■使い方

メニューバーの [ファイル] -> [ファイルを開く] で展開したいアーカイブファイルを開きます。
ウィンドウにドラッグ＆ドロップしても開けます。

そのファイルに対応していればリストにファイルの中身が表示されます。

対応していない場合は検索確認ダイアログが表示されます。
「はい」をクリックすると、AHX、BMP、JPG、MID、MPG、OGG、PNG、WAV、WMVをアーカイブファイル内から探します。

選択したファイルだけを抽出するときは、リストに表示されているファイルを選択して、[抽出] -> [選択範囲を抽出] で抽出します。
全てのファイルを抽出するときは、[抽出] -> [すべて抽出] で抽出します。
右クリックメニューからでも抽出できます。

[変換せずに選択範囲を抽出] や [変換せずにすべて抽出] で抽出を行うと、ファイルの変換が行われず、アーカイブに格納されているままの状態で抽出できます。
デバッグのときなどにご使用ください。
なお、Susieプラグインで開いたものに対しては効果はありません。仕様です。

選択したファイルをダブルクリックすると、閲覧・再生が出来ます。
閲覧・再生元のファイルはテンポラリフォルダに出力されます。


■メニュー項目の説明

・ファイル
[ファイルを開く] …… アーカイブファイルを開きます。
[閉じる] …… 開いているアーカイブファイルを閉じます。
[終了] …… ExtractDataを終了します。

・抽出
[選択範囲を抽出] …… 選択したファイルだけを抽出します。
[すべて抽出] …… 全てのファイルを抽出します。
[変換せずに選択範囲を抽出] …… 選択したファイルだけを変換せずに抽出します。
[変換せずにすべて抽出] …… 全てのファイルを変換せずに抽出します。

・設定
[オプション] …… オプションダイアログを表示します。

・ヘルプ
[Readme.txt] …… Readme.txt(今見ているもの)を開きます。
[History.txt] …… History.txtを開きます。
[State.txt] …… State.txtを開きます。
[バージョン情報] …… ExtractDataのバージョンが確認出来ます。


■オプション項目の説明

[基本設定]

・リストの設定
ファイル情報を表示するリストの背景色と文字色を設定します。
色の指定方法はRGBを16進数で記述してください。RRGGBB形式です。

・検索するファイル
対応していないアーカイブファイルから、どの種類のファイルを探すかを設定します。
アーカイブされているファイルがわかっている場合には、それのみにチェックすることを推奨します(速度的な意味で)。

・検索精度
OGGを"OggS"のみで探すか、もう少しチェックして探すかを設定します。
誤検出を防ぐため、普段は検索精度を上げておくことを推奨します。


[抽出設定]

・フォルダごと抽出する
抽出するファイルのファイル名にフォルダ名が含まれている場合、フォルダも生成します。

・OGGファイルのCRCを修正する
Ogg Vorbisファイル抽出時にCRCを修正して抽出します。
CRCを修正することで、CRC不一致により再生できないOgg Vorbisを再生できるようになるかもしれません。
普段は無効にしておくことを推奨します。

・簡易復号機能を有効にする
暗号化されているファイルに対して単純な復号処理を施します。
今のところ、bmp、jpg、mpg、ogg、png、tlg、吉里吉里のスクリプトファイルのみが対象です。
誤動作しやすいため、普段は無効にしておくことを推奨します。

・出力画像形式
出力する画像のファイル形式です。
PNGを指定すると画像抽出時の速度は落ちますが、ファイル容量を抑えられます。
圧縮レベルは0が無圧縮で、9が最高圧縮となっています。
なお、元々のファイルがJPGやPNGの場合は、JPGやPNGのまま出力されます。

・αブレンドを行う
設定した背景色とアルファブレンドを行い、24bitで出力します。
アルファ値が必要な場合は無効にしてください。

・背景色
アルファブレンド時に使用する背景です。
色の指定方法はRGBを16進数で記述します。RRGGBB形式です。

・高速に処理する
アルファブレンドの処理をMMXを使用して高速に処理します。
ただし、MMXの仕様(除算ができない)により、通常の速度でアルファブレンドした場合と結果が少し異なります。
急いでいる場合のみ有効にすることを推奨します。

・出力先
「毎回指定する」場合、抽出を行うたびに出力先を指定するダイアログが表示されます。
「入力先と同じフォルダ」の場合、開いたファイルがある場所に、開いたファイルと同名のフォルダを作成し、その中に出力します。格納されているファイルが1つの場合は、その場所と同名のフォルダを作成します。
「下記のフォルダ」の場合、下記で指定したフォルダに出力します。

・バッファサイズ
ファイルを抽出する際に使用するメモリの大きさです。KB単位で指定します。
大きいほどメモリを消費しますが、HDDに優しくなる、ような気がします。

・テンポラリフォルダ
ダブルクリックで閲覧・再生した場合に、一時的に抽出する場所です。
一時的に抽出されたファイルは、アーカイブファイルを開いたときや、ExtractDataを終了したときに削除されます。
削除できなかったファイルは「TmpFileList.txt」に記録され、次回削除されます。


[Susie設定]

・Susieプラグインを使用する
Susieプラグインを使用してファイルを開いたり抽出したりします。
なお、プラグインが読み込まれるタイミングは、ExtractData起動時と、更新ボタンを押したときだけです。
Susieプラグインを使用しない場合はプラグインの読み込みは行われません。

・Susieプラグインを優先する
内蔵エンジンよりも先にSusieプラグインを使用して開いたり抽出したりします。
Susieプラグインの方が優れている場合に使用してください。

・各プラグインのON/OFF
リストに表示されているファイルが現在読み込まれているSusieプラグインです。
チェックの有無によりプラグインの使用を設定できます。
他のプラグインが邪魔で正常に開けないときなどに使用してください。

・Susieプラグイン自身の設定
青色で表示されているプラグインは設定ダイアログを実装したプラグインです。
右クリックメニューから設定を呼び出すことが可能です。


■ショートカットキー一覧

Ctrl+O …… ファイルを開く
Ctrl+W …… 閉じる
Ctrl+Q …… 終了

Ctrl+S …… 選択範囲を抽出
Ctrl+Shift+S …… すべて抽出

Ctrl+E …… オプション

Ctrl+A …… すべて選択


■アンインストール方法

フォルダごと削除してください。
レジストリには一切書き込んでいません。


■報告等についての注意

バグ報告については大歓迎です。
その際はバグが出たときの状況(どのような操作を行ったかなど)をできるだけ詳しく書いていただけると、こちらでもバグを容易に再現でき、修正しやすくなります。

動作報告についてはファイル検索機能を使わずに開けたもののみ受け付けます。キリがない気がするので。
NScripterや吉里吉里を使用しているタイトルについては報告されても対応リストに載せません。というか載せ切れません。
ただし、tpmで暗号化されているタイトルは例外です。正常に抽出できた場合はご報告ください。リストに載せます。

リクエストについては受け付けておりません。
気が向いたときにしか解析しません。

ExtractData自体に対する機能追加・改善等は受け付けます。
フレームワークが完成するまではほいほいと実装できませんが。


■謝辞

・nwa -> wav変換に jagarl 氏の nwatowav のソースを参考にしました。
・XP3アーカイブの展開に にっくる 氏の xp3dec のソースを参考にしました。
・MELTY BLOODのアーカイブ展開に hikobae 氏の mbextract のソースを参考にしました。
・最終試験くじらのcpsの復号に hikobae 氏の Isana のソースを参考にしました。
・DSCとCompressedBGの復号に 十一寒月 氏の nr のソースを参考にしました。
・FilePackVer1.0と2.0の展開に 十一寒月 氏の gage のソースを参考にしました。
・CPZ1とCPZ2の展開に 十一寒月 氏の cpz のソースを参考にしました。
・iarの画像展開に 十一寒月 氏の iar のソースを参考にしました。
・FilePackVer3.0の展開に asmodean 氏の exfp3 のソースを参考にしました。
・PS2版CLANNADの音声抽出に 191 氏の decahx のソースや、258 氏の makekoe のソースを参考にしました。
・rct/rc8の復号に Peter Jolly 氏の MAJIRO用のSusieプラグイン のソースを参考にしました。
・SummerDaysのアーカイブ展開に sdsplit のソースを参考にしました。
・TCD3のSPDC解凍に asmodean 氏の extcd3 のソースを参考にしました。
・アイコンを おとと 氏に作成していただきました。
上記の件につきまして、この場を借りて御礼申し上げます。ありがとうございました。


■著作権

・OGGのCRC修正機能は、Xiph.org Foundationが作成・配布しているソースを使って作られています。
・nbzの解凍は、Julian R Seward 氏の bzip2 のソースを使って作られています。


■今後の予定

・プレビュー機能の実装
・フォルダ読み込み機能の実装
・ファイル名検索機能の実装
・ファイル情報コピー機能の実装
・MFC風フレームワークの開発・組込
・YKGのマスク合成
・dltの解析
・voice.datの解析
